name: Secure Development Workflow

on: [push]

jobs:
  combined:
    runs-on: ubuntu-latest

    steps:
      - name: Harden Runner
        uses: step-security/harden-runner@5c7944e73c4c2a096b17a9cb74d65b6c2bbafbde # v2.9.1
        with:
          egress-policy: audit

      - uses: actions/checkout@692973e3d937129bcbf40652eb9f2f61becf3332 # v4.1.7
      - name: Vulnerability scan
        uses: debricked/actions@659ae7accc12313772fbfbd1b1fccec31772ce41 # v4.0.0
        env:
          DEBRICKED_TOKEN: ${{ secrets.DEBRICKED_TOKEN }}
      - name: Resolve vulnerabilities
        if: always()  # Always attempt resolution, even after failures
        uses: debricked/actions/resolve@659ae7accc12313772fbfbd1b1fccec31772ce41 # v4.0.0
        env:
          DEBRICKED_TOKEN: ${{ secrets.DEBRICKED_TOKEN }}
          # Add optional inputs for vulnerability prioritization and resolution strategies
          # e.g., DEBRICKED_RESOLVE_STRATEGY: upgrade, DEBRICKED_SEVERITY_THRESHOLD: high
          # See https://debricked.com/docs/actions/resolve for complete list
